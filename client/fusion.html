<template name="PivotTable">

<div class="around-intro">
    <div class="intro">
      <h1>Data Fusion Tool</h1>
        This application allows you to fuse clinical, research, genomic and pathway data into beautiful visualizations.
    </div>
</div>

    {{> Controls }}

    <div style="display: inline-block;" class="dataExplorerControlPanel">
        <div class="output" style="margin: 30px;"></div>
    </div>
</template>


<template name="Controls">
    <div class="panel panel-default">
      <div class="panel-heading" data-toggle="collapse" data-target="#p1" >

          <h3 class="panel-title">1. Select Studies (required)</h3>
       </div>
       <div id="p1" class="panel-body collapse">
         <select id="studies"  multiple="multiple">
            {{#each studies}}
               <option value="{{this.id}}">{{this.name}}</option>
            {{/each}}
         </select>
         <div>

             {{> reactiveTable showNavigation="auto" fields=["id", "description"]
                  settings=studiesSelectedSettings class="studiesSelectedTable"
                  collection=studiesSelected rowsPerPage=20 class="studiesSelectedTable table borderless" }}
         </div>
       </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading" data-toggle="collapse" data-target="#p2">
          <h3 class="panel-title">2. Select Genes (optional)
          </h3>
       </div>
       <div id="p2" class="panel-body collapse">
              <input class="genelist" style="width:100%;" id="genelist" placeholder="Enter HUGO Gene Symbols or Gene Aliases" name="genelist">
              <span>
              <button id="clear">Clear Gene List</button>
            <select id="genesets">
              <option >Gene Sets</option>
              {{#each genesets}}
                  <option>{{this.name}}</option>
              {{/each}}
            </select>
              <button id="clear">All Genes In</button>
              <br>

              <a href="#" class="topMutatedGenes">Top Mutated Genes</a>
              </span>
        {{>checkBox list=geneLikeDataDomains}}
        </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading"  data-toggle="collapse" data-target="#p3">
          <h3 class="panel-title">3. Include additional Clinical Report Forms and other data (optional)</h3>
       </div>
       <div id="p3" class="panel-body collapse">
         <select id="additionalQueries"  multiple="multiple">
            {{{additionalQueries}}}
        </select>
       </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
          <h3 class="panel-title"  data-toggle="collapse" data-target="#p4" >4. Filter to these Patients or Samples (optional)</h3>
       </div>
       <div id="p4" class="panel-body collapse">
              <input style="width:100%;" id="samplelist" placeholder="Enter PatientID or Sample ID">
              <a href="#" class="inspect" data-var="ChartData"> Inspect {{Count "Clinical_Info"}} records.</a>
        </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
          <h3 class="panel-title"  data-toggle="collapse" data-target="#p5" >5. Rename, BIN or Transform the data</h3>
       </div>
       <div id="p5" class="panel-body collapse">
            {{> Transforms }}

              <a href="#" class="inspect" data-var="ChartData"> Inspect {{Count "Clinical_Info"}} records.</a>

        </div>
    </div>
</template>

<template name="Transforms">
 <table class="table table-striped">
     {{#each dataFieldNames}}
     <tr>
         <td>
                {{this}}&nbsp;
         </td>

         <td>
                <span>rename to
                    <input name="{{this}}" data-op="rename" data-precedence=2 data-field={{this}} class="transform" type="text">
                </span>
         </td>

         <td>
                <span>Bin it
                    <input style="width:40px;" name="{{this}}" data-op="bin" data-precedence=1 data-field={{this}} class="transform" type="number">
                </span>
         </td>
     </tr>
     {{/each}}
  </table>
 </template>


<template name="checkBox">
    {{#each list}}
      <span class="checkbox">
          <label>
                <input name="{{this.checkBoxName}}" data-field={{this.field}} 
                data-collection={{this.collection}} 
                class="geneLikeDataDomains" type="checkbox">{{this.label}}
          </label>
          <br>
      </span>
    {{/each}}
</template>


<template name="charts">
  <h2>Charts</h2>
  <div id="chart1" width="100%"></div>
  <input id="slider" type="range"/>
</template>

<template name="gene_set">
  <h2>Geneset</h2>
  <div id="chart1" width="100%"></div>
</template>
